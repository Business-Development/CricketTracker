# Cricket Shot Classifier
This project's aim was to create a machine learning model that can classify a batsman playing a shot in cricket. This was done by creating training data and using Google's [Video Intelligence API](https://cloud.google.com/video-intelligence), that has a feature called Person Detection. Using the data obtained from running the videos through the API, I then trained a Long Short Term Memory (LSTM) Network which was then used to classify a test set of videos. The model had excellent accuracy on the test set (97%) and with more training data, this model can be expanded to classify other cricket shots.
# Training Data
Firstly I was required to create some training data. I chose three shots to perform:
- Forward Defensive
- Backfoot Defensive
- Cover Drive

These shots were chosen because I could consistently repeat the shot with little variation, which is beneficial when training the model. Furthermore, the **forward defensive** and **cover drive** are similar in their movements so it was a good test to see if the model could differentiate between the two shots accurately.  
I recorded fifty of each type of shot, totalling 150 videos to input into the model.
# Using Pose Detection
The first step was to run the Pose Detection API on the videos. The API takes a video and outputs the position, in the x & y directions, of key body parts such as, ankle, elbow, shoulder etc... 
The following table shows an example of the output I recieved from the API:
|    |   timestamp |   nose_x |   nose_y |   left_eye_x |   left_eye_y |   right_eye_x |   right_eye_y |   right_ear_x |   right_ear_y |   left_shoulder_x |   left_shoulder_y |   right_shoulder_x |   right_shoulder_y |   left_elbow_x |   left_elbow_y |   right_elbow_x |   right_elbow_y |   left_wrist_x |   left_wrist_y |   right_wrist_x |   right_wrist_y |   left_hip_x |   left_hip_y |   right_hip_x |   right_hip_y |   left_knee_x |   left_knee_y |   right_knee_x |   right_knee_y |   left_ankle_x |   left_ankle_y |   right_ankle_x |   right_ankle_y |   left_ear_x |   left_ear_y |
|----|-------------|----------|----------|--------------|--------------|---------------|---------------|---------------|---------------|-------------------|-------------------|--------------------|--------------------|----------------|----------------|-----------------|-----------------|----------------|----------------|-----------------|-----------------|--------------|--------------|---------------|---------------|---------------|---------------|----------------|----------------|----------------|----------------|-----------------|-----------------|--------------|--------------|
|  0 |         0   | 0.529561 | 0.649577 |     0.529561 |     0.655916 |      0.518296 |      0.655916 |      0.476993 |      0.653803 |          0.522051 |          0.596754 |           0.386877 |           0.607318 |       0.548335 |       0.533365 |        0.330554 |        0.54393  |       0.499522 |       0.501671 |        0.386877 |        0.520687 |     0.469483 |     0.472089 |      0.383122 |      0.478428 |      0.458219 |      0.377006 |       0.360593 |       0.383345 |       0.446954 |       0.288262 |        0.326799 |        0.290375 |            0 |            0 |
|  1 |         0.1 | 0.531503 | 0.650036 |     0.527778 |     0.656325 |      0.520327 |      0.656325 |      0.475621 |      0.654228 |          0.520327 |          0.595529 |           0.38621  |           0.608107 |       0.546405 |       0.532636 |        0.326603 |        0.545214 |       0.494249 |       0.50119  |        0.367583 |        0.528443 |     0.46817  |     0.469743 |      0.378759 |      0.473936 |      0.460719 |      0.375404 |       0.360132 |       0.381694 |       0.442092 |       0.289451 |        0.330328 |        0.293644 |            0 |            0 |
|  2 |         0.2 | 0.530353 | 0.649488 |     0.530353 |     0.657831 |      0.519235 |      0.657831 |      0.474759 |      0.655745 |          0.522941 |          0.597347 |           0.389513 |           0.607775 |       0.548885 |       0.532691 |        0.326505 |        0.545205 |       0.496996 |       0.501407 |        0.3821   |        0.524349 |     0.471052 |     0.470122 |      0.3821   |      0.476379 |      0.459933 |      0.376267 |       0.359862 |       0.38461  |       0.445108 |       0.28867  |        0.330212 |        0.290755 |            0 |            0 |
|  3 |         0.3 | 0.535423 | 0.650141 |     0.531696 |     0.656433 |      0.520516 |      0.656433 |      0.479521 |      0.656433 |          0.524243 |          0.599809 |           0.390077 |           0.608197 |       0.55033  |       0.532699 |        0.326721 |        0.545282 |       0.498155 |       0.501241 |        0.378897 |        0.522213 |     0.46834  |     0.47188  |      0.382624 |      0.478172 |      0.45716  |      0.379604 |       0.360263 |       0.381701 |       0.442253 |       0.289425 |        0.326721 |        0.289425 |            0 |            0 |
|  4 |         0.4 | 0.533425 | 0.649284 |     0.529748 |     0.657559 |      0.522396 |      0.657559 |      0.47828  |      0.65549  |          0.526072 |          0.599633 |           0.390048 |           0.609977 |       0.551806 |       0.531363 |        0.32755  |        0.545845 |       0.496661 |       0.500332 |        0.382695 |        0.523088 |     0.470927 |     0.471369 |      0.382695 |      0.477575 |      0.459898 |      0.378274 |       0.360637 |       0.382412 |       0.441516 |       0.289316 |        0.331226 |        0.293454 |            0 |            0 |
|  5 |         0.5 | 0.535759 | 0.649952 |     0.535759 |     0.658256 |      0.524691 |      0.658256 |      0.480421 |      0.658256 |          0.524691 |          0.600128 |           0.391882 |           0.610508 |       0.550515 |       0.53162  |        0.325477 |        0.544076 |       0.498867 |       0.50048  |        0.39926  |        0.519164 |     0.473043 |     0.471417 |      0.380814 |      0.477645 |      0.458286 |      0.375921 |       0.358679 |       0.382149 |       0.44353  |       0.288729 |        0.325477 |        0.288729 |            0 |            0 |
|  6 |         0.6 | 0.537709 | 0.649502 |     0.537709 |     0.657868 |      0.526559 |      0.657868 |      0.48196  |      0.657868 |          0.526559 |          0.6014   |           0.392762 |           0.611857 |       0.552575 |       0.534474 |        0.32958  |        0.549114 |       0.496826 |       0.501011 |        0.392762 |        0.519834 |     0.474527 |     0.471731 |      0.385329 |      0.478006 |      0.455944 |      0.377617 |       0.363029 |       0.3818   |       0.441078 |       0.291869 |        0.32958  |        0.291869 |            0 |            0 |
|  7 |         0.7 | 0.542355 | 0.652467 |     0.538579 |     0.658843 |      0.531025 |      0.658843 |      0.485706 |      0.658843 |          0.527249 |          0.599337 |           0.391289 |           0.612088 |       0.553685 |       0.533455 |        0.327086 |        0.546206 |       0.493259 |       0.499451 |        0.395066 |        0.520703 |     0.470599 |     0.471823 |      0.383736 |      0.478198 |      0.463046 |      0.378313 |       0.361076 |       0.382563 |       0.444162 |       0.291178 |        0.327086 |        0.289053 |            0 |            0 |
|  8 |         0.8 | 0.544999 | 0.650795 |     0.541177 |     0.659398 |      0.529711 |      0.659398 |      0.487669 |      0.657248 |          0.529711 |          0.597026 |           0.392118 |           0.609931 |       0.552644 |       0.530352 |        0.323321 |        0.55186  |       0.491491 |       0.49809  |        0.388296 |        0.521749 |     0.472381 |     0.474432 |      0.380652 |      0.480884 |      0.476203 |      0.379798 |       0.357719 |       0.381949 |       0.449448 |       0.289465 |        0.323321 |        0.287315 |            0 |            0 |
|  9 |         0.9 | 0.562657 | 0.648057 |     0.558921 |     0.656467 |      0.547712 |      0.656467 |      0.502875 |      0.652262 |          0.540239 |          0.589186 |           0.40573  |           0.610211 |       0.551448 |       0.517699 |        0.319795 |        0.557647 |       0.484194 |       0.496674 |        0.387049 |        0.519802 |     0.480457 |     0.473545 |      0.387049 |      0.479853 |      0.517821 |      0.383136 |       0.360894 |       0.378931 |       0.461776 |       0.288521 |        0.327267 |        0.292727 |            0 |            0 |
| 10 |         1   | 0.58677  | 0.637805 |     0.58677  |     0.646092 |      0.575724 |      0.646092 |      0.527861 |      0.644021 |          0.560997 |          0.581866 |           0.428454 |           0.606728 |       0.549952 |       0.50728  |        0.325365 |        0.571506 |       0.472635 |       0.488633 |        0.384273 |        0.519711 |     0.494726 |     0.465843 |      0.399    |      0.47413  |      0.542589 |      0.385042 |       0.362182 |       0.376754 |       0.527861 |       0.287666 |        0.318001 |        0.283522 |            0 |            0 |
| 11 |         1.1 | 0.634554 | 0.615158 |     0.634554 |     0.623511 |      0.623422 |      0.625599 |      0.575183 |      0.627687 |          0.593736 |          0.565044 |           0.471285 |           0.596366 |       0.571473 |       0.494049 |        0.356255 |        0.567132 |       0.486128 |       0.468992 |        0.411915 |        0.502402 |     0.504681 |     0.462728 |      0.411915 |      0.475257 |      0.564051 |      0.377116 |       0.389651 |       0.375028 |       0.638264 |       0.2748   |        0.322859 |        0.283153 |            0 |            0 |
| 12 |         1.2 | 0.67136  | 0.587102 |     0.675086 |     0.595488 |      0.660184 |      0.597584 |      0.61548  |      0.605969 |          0.634107 |          0.549368 |           0.50372  |           0.576621 |       0.622931 |       0.475996 |        0.406862 |        0.530501 |       0.526072 |       0.442454 |        0.455291 |        0.475996 |     0.544699 |     0.448743 |      0.44784  |      0.461321 |      0.604304 |      0.364889 |       0.406862 |       0.362793 |       0.660184 |       0.257975 |        0.313728 |        0.278939 |            0 |            0 |
| 13 |         1.3 | 0.704062 | 0.564591 |     0.713849 |     0.571935 |      0.694275 |      0.57377  |      0.648602 |      0.584785 |          0.684488 |          0.533382 |           0.557256 |           0.555412 |       0.717112 |       0.465457 |        0.469173 |        0.498502 |       0.642078 |       0.425069 |        0.52137  |        0.448935 |     0.599667 |     0.434248 |      0.498534 |      0.443427 |      0.671439 |      0.369994 |       0.456123 |       0.351636 |       0.677964 |       0.254337 |        0.325629 |        0.278203 |            0 |            0 |
| 14 |         1.4 | 0.724517 | 0.55478  |     0.734982 |     0.562633 |      0.714051 |      0.564596 |      0.672188 |      0.578338 |          0.724517 |          0.535149 |           0.59195  |           0.535149 |       0.81522  |       0.497849 |        0.571018 |        0.450734 |       0.780334 |       0.444845 |        0.686142 |        0.429139 |     0.630324 |     0.419324 |      0.532644 |      0.417361 |      0.721028 |      0.362393 |       0.480315 |       0.327057 |       0.682654 |       0.252457 |        0.337282 |        0.283868 |            0 |            0 |
| 15 |         1.5 | 0.737671 | 0.548623 |     0.752788 |     0.55713  |      0.730112 |      0.559256 |      0.688539 |      0.572017 |          0.726333 |          0.542242 |           0.616731 |           0.531609 |       0.824596 |       0.546496 |        0.696098 |        0.452919 |       0.847272 |       0.542242 |        0.835934 |        0.461426 |     0.665863 |     0.425271 |      0.571379 |      0.423144 |      0.745229 |      0.361468 |       0.495792 |       0.32744  |       0.68476  |       0.250877 |        0.340838 |        0.280652 |            0 |            0 |
| 16 |         1.6 | 0.764852 | 0.549084 |     0.777169 |     0.558326 |      0.756641 |      0.560636 |      0.711478 |      0.574498 |          0.723795 |          0.542153 |           0.645787 |           0.532911 |       0.756641 |       0.52367  |        0.781275 |        0.484393 |       0.859283 |       0.588361 |        0.867494 |        0.521359 |     0.678632 |     0.422013 |      0.592413 |      0.422013 |      0.764852 |      0.361943 |       0.510299 |       0.324977 |       0.686844 |       0.253354 |        0.346071 |        0.281079 |            0 |            0 |
| 17 |         1.7 | 0.783096 | 0.560688 |     0.799246 |     0.567504 |      0.779059 |      0.572048 |      0.734647 |      0.590223 |          0.73061  |          0.560688 |           0.670048 |           0.547056 |       0.819433 |       0.524336 |        0.827508 |        0.515248 |       0.879994 |       0.603855 |        0.896144 |        0.576592 |     0.690236 |     0.428914 |      0.609487 |      0.428914 |      0.770984 |      0.363027 |       0.516627 |       0.333491 |       0.690236 |       0.253972 |        0.351092 |        0.288051 |            0 |            0 |
| 18 |         1.8 | 0.790734 | 0.568779 |     0.806311 |     0.577545 |      0.78684  |      0.579736 |      0.747898 |      0.599459 |          0.732322 |          0.570971 |           0.681697 |           0.557823 |       0.814099 |       0.555631 |        0.841359 |        0.529335 |       0.872512 |       0.623564 |        0.891983 |        0.60165  |     0.69338  |     0.430724 |      0.607708 |      0.435106 |      0.767369 |      0.358409 |       0.514248 |       0.338686 |       0.689486 |       0.253223 |        0.346798 |        0.290476 |            0 |            0 |
| 19 |         1.9 | 0.801281 | 0.576653 |     0.813318 |     0.585684 |      0.793256 |      0.587942 |      0.757146 |      0.606005 |          0.745109 |          0.574395 |           0.688937 |           0.563106 |       0.797269 |       0.554075 |        0.841404 |        0.536012 |       0.86949  |       0.617294 |        0.897576 |        0.587942 |     0.692949 |     0.436668 |      0.612703 |      0.438926 |      0.76517  |      0.359902 |       0.516409 |       0.346355 |       0.684924 |       0.253784 |        0.347893 |        0.294425 |            0 |            0 |
| 20 |         2   | 0.808115 | 0.57939  |     0.820567 |     0.588733 |      0.799814 |      0.591069 |      0.758308 |      0.607418 |          0.750007 |          0.581726 |           0.691898 |           0.567712 |       0.803964 |       0.614425 |        0.849621 |        0.539684 |       0.882826 |       0.64946  |        0.90773  |        0.600411 |     0.696049 |     0.436915 |      0.613037 |      0.441586 |      0.766609 |      0.359838 |       0.517573 |       0.348159 |       0.683597 |       0.252397 |        0.347398 |        0.292104 |            0 |            0 |
| 21 |         2.1 | 0.812573 | 0.583151 |     0.825023 |     0.592492 |      0.804273 |      0.594827 |      0.758623 |      0.611175 |          0.754473 |          0.57848  |           0.696373 |           0.569139 |       0.812573 |       0.606504 |        0.854073 |        0.54345  |       0.891423 |       0.650875 |        0.908023 |        0.601833 |     0.700523 |     0.438361 |      0.617523 |      0.443031 |      0.766923 |      0.35896  |       0.517923 |       0.347283 |       0.688073 |       0.25387  |        0.347773 |        0.291235 |            0 |            0 |

After importing the data as a pandas dataframe, a certain amount of preprocessing had to be completed to prepare the data to be used for the model. The preprocessing steps can be seen in this [notebook](https://github.com/anudeepayina/CricketTracker/blob/master/Data_Preprocessing.ipynb).
After preprocessing, I created training and testing data and then I was prepared to create the classification model.

# Classification using Long Short Term Memory Network
## Architecture
The google collabs can be viewed [here](https://github.com/anudeepayina/CricketTracker/blob/master/LSTM_algorithm.ipynb)
LSTM was the algorithm chosen. This is because this is a time-series classification problem, where information from the previous timestep has some indication of the next. An LSTM can use the sequence of input data to classify the shot played, and treats the data as a whole instead of independently. 

The model consisted of two LSTM cells (256 nodes each) and one dropout layer between the cells. Finally, it had one Dense layer with softmax activation. 
## Results
After passing the test data through the model, an accuracy of 97% was achieved. This was a very promising result as the training data was limited to 38 videos per shot. With additional training data, a higher level of accuracy could be achieved. When eight additional sets of test data were passed into the model and predictions were obtained, the model predicted six of the eight correctly. This can be viewed [here](https://youtu.be/wsUOkzu-dtg)
## Future Work
With more data, the model can be expanded to other cricket shots. 
